"use strict";(globalThis.webpackChunkphysical_humanoid_robotics_book=globalThis.webpackChunkphysical_humanoid_robotics_book||[]).push([[323],{1264(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>s});const r=JSON.parse('{"id":"modules/module-1/module-1-chapter-2","title":"Advanced ROS 2 Communication Patterns","description":"In this chapter, we\'ll explore advanced communication patterns in ROS 2 that are essential for building complex robotic systems.","source":"@site/content/modules/module-1/chapter-2.md","sourceDirName":"modules/module-1","slug":"/modules/module-1/module-1-chapter-2","permalink":"/docs/modules/module-1/module-1-chapter-2","draft":false,"unlisted":false,"editUrl":"https://github.com/physical-humanoid-robotics/physical-humanoid-robotics-book/tree/main/packages/create-docusaurus/templates/shared/content/modules/module-1/chapter-2.md","tags":[],"version":"current","frontMatter":{"id":"module-1-chapter-2","title":"Advanced ROS 2 Communication Patterns","sidebar_label":"ROS 2 Patterns"},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Basics","permalink":"/docs/modules/module-1/module-1-chapter-1"},"next":{"title":"Humanoid Control","permalink":"/docs/modules/module-1/module-1-chapter-3"}}');var t=i(4848),o=i(8453);const a={id:"module-1-chapter-2",title:"Advanced ROS 2 Communication Patterns",sidebar_label:"ROS 2 Patterns"},l="Advanced ROS 2 Communication Patterns",c={},s=[{value:"Action Servers and Clients",id:"action-servers-and-clients",level:2},{value:"Parameter Server",id:"parameter-server",level:2},{value:"Lifecycle Nodes",id:"lifecycle-nodes",level:2},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:2},{value:"Exercise: Implement a Lifecycle Node",id:"exercise-implement-a-lifecycle-node",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"advanced-ros-2-communication-patterns",children:"Advanced ROS 2 Communication Patterns"})}),"\n",(0,t.jsx)(n.p,{children:"In this chapter, we'll explore advanced communication patterns in ROS 2 that are essential for building complex robotic systems."}),"\n",(0,t.jsx)(n.h2,{id:"action-servers-and-clients",children:"Action Servers and Clients"}),"\n",(0,t.jsx)(n.p,{children:"Actions are a more complex form of communication that involve sending a goal, receiving feedback during processing, and returning a result. They are ideal for long-running tasks."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\n\nfrom example_interfaces.action import Fibonacci\n\n\nclass FibonacciActionServer(Node):\n\n    def __init__(self):\n        super().__init__('fibonacci_action_server')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'fibonacci',\n            self.execute_callback)\n\n    def execute_callback(self, goal_handle):\n        self.get_logger().info('Executing goal...')\n\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        for i in range(1, goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Goal canceled')\n                return Fibonacci.Result()\n\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\n\n            self.get_logger().info('Publishing feedback: {0}'.format(\n                feedback_msg.sequence))\n\n            goal_handle.publish_feedback(feedback_msg)\n\n        goal_handle.succeed()\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n\n        self.get_logger().info('Returning result: {0}'.format(result.sequence))\n\n        return result\n"})}),"\n",(0,t.jsx)(n.h2,{id:"parameter-server",children:"Parameter Server"}),"\n",(0,t.jsx)(n.p,{children:"ROS 2 provides a parameter server for runtime configuration of nodes. Parameters can be declared and used to configure behavior without recompiling."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Declaring parameters\nself.declare_parameter('frequency', 10)\nself.declare_parameter('robot_name', 'turtlebot')\n\n# Getting parameter values\nfrequency = self.get_parameter('frequency').value\nrobot_name = self.get_parameter('robot_name').value\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lifecycle-nodes",children:"Lifecycle Nodes"}),"\n",(0,t.jsx)(n.p,{children:"Lifecycle nodes provide a state machine for managing the complex startup, shutdown, and error recovery processes common in robotic systems."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from rclpy.lifecycle import LifecycleNode, LifecycleState\nfrom rclpy.lifecycle import TransitionCallbackReturn\n\n\nclass LifecycleTalker(LifecycleNode):\n\n    def __init__(self):\n        super().__init__('lifecycle_talker')\n        self.pub = None\n\n    def on_configure(self, state: LifecycleState):\n        self.pub = self.create_publisher(String, 'lifecycle_chatter', 10)\n        self.get_logger().info('Configured lifecycle talker')\n        return TransitionCallbackReturn.SUCCESS\n\n    def on_activate(self, state: LifecycleState):\n        self.get_logger().info('Activated lifecycle talker')\n        return super().on_activate(state)\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Lifecycle chatter'\n        self.pub.publish(msg)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,t.jsx)(n.p,{children:"QoS profiles allow you to specify delivery guarantees for topics, which is crucial for safety-critical robotic applications."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSDurabilityPolicy, QoSReliabilityPolicy\n\n# Reliable communication with durability\nqos_profile = QoSProfile(\n    depth=10,\n    durability=QoSDurabilityPolicy.TRANSIENT_LOCAL,\n    reliability=QoSReliabilityPolicy.RELIABLE\n)\n\npublisher = node.create_publisher(String, 'topic', qos_profile)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"exercise-implement-a-lifecycle-node",children:"Exercise: Implement a Lifecycle Node"}),"\n",(0,t.jsx)(n.p,{children:"Create a lifecycle node that controls a simulated motor. The node should have the following states:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Unconfigured \u2192 Configured (when parameters are set)"}),"\n",(0,t.jsx)(n.li,{children:"Inactive \u2192 Active (when motor is ready)"}),"\n",(0,t.jsx)(n.li,{children:"Active \u2192 Inactive (when motor is stopped)"}),"\n",(0,t.jsx)(n.li,{children:"Cleanup and shutdown states"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.p,{children:"Advanced ROS 2 communication patterns provide the tools needed for complex robotic systems. Actions for long-running tasks, parameters for configuration, lifecycle nodes for state management, and QoS settings for reliability are all essential for professional robotic applications."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["Continue to ",(0,t.jsx)(n.a,{href:"/docs/module-1-chapter-3",children:"Chapter 3: ROS 2 for Humanoid Robot Control"})]})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>l});var r=i(6540);const t={},o=r.createContext(t);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);